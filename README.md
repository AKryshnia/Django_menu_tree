# Django Menu Tree App

Это Django-приложение реализует гибкое древовидное меню, редактируемое через админку, отображаемое на страницах с помощью шаблонного тега.

Проект следует условиям тестового задания:

---

## Быстрый старт

```bash
git clone https://github.com/AKryshnia/Django_menu_tree.git
cd Django_menu_tree
python -m venv .venv
source .venv/bin/activate  # или .venv\Scripts\activate на Windows
pip install -r requirements.txt
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver
```
Чувствительные данные (SECRET_KEY Джанго, DEBUG, ALLOWED_HOSTS) хранятся в .env в корне проекта.

## Устройство проекта

| Компонент      | Описание                                                                |
| -------------- | ----------------------------------------------------------------------- |
| `MenuItem`     | Модель меню. Содержит `name`, `menu_name`, `url`, `named_url`, `parent` |
| `menu_tags.py` | Шаблонные теги `draw_menu` и `get_menu_names`                           |
| `menu.html`    | Рекурсивный шаблон, отрисовывающий всё дерево                           |
| `MenuView`     | View, отображающий шаблон с меню                                        |
| `tests.py`     | Покрытие функционала, включая активный путь, разворачивание, named\_url |

## Структура меню

Каждый пункт меню:

- Принадлежит меню (menu_name)
- Может иметь родителя (parent)
- Может вести по url или named_url
- Может иметь потомков (любая глубина)

## Использование в шаблоне

```
{% load menu_tags %}
{% draw_menu 'main_menu' %}
```

Или отрисовать все найденные меню:

```
{% get_menu_names as menu_list %}
{% for name in menu_list %}
    <h2>{{ name }}</h2>
    {% draw_menu name %}
{% endfor %}
```

## Пример меню (в админке)

```
main_menu
├── Главная          /                      (parent: None)
├── О нас            /about/               (parent: None)
│   └── Команда      /about/team/          (parent: О нас)
│       ├── Dev      /about/team/dev/      (parent: Команда)
│       └── Design   /about/team/design/   (parent: Команда)
└── Контакты         /contacts/            (parent: None)
```

## Что отрисовывается на странице

- Разворачивается всё выше активного пункта
- Первый уровень вложенности под активным тоже разворачивается
- Все пункты сортируются по position

## Админка

Создавать меню можно через стандартную админку Django.
- menu_name — это логическое имя меню, например: main_menu, footer_menu и т.д.
- menu_name автоматически очищается от пробелов и приводится к нижнему регистру.

## Тесты

Проект содержит функциональные тесты без жёсткой привязки к структуре:

```
python manage.py test menu_app
```

Покрытие:

- Отображение меню
- Подсветка активного пункта
- Разворачивание цепочки родителей
- Скрытие подменю
- Поддержка named_url
- Автозаполнение position
- Независимость разных меню

## Особенности реализации

- Используется один SQL-запрос (select_related)
- menu_name очищается в save(): strip().lower()
- Шаблон рекурсивный (menu_item.html), глубина не ограничена
- position выставляется автоматически, если не задано

## Важно: named_url

Чтобы корректно работал named_url, маршрут должен быть зарегистрирован по имени.
Для тестов и демо включён маршрут:

```
path('', MenuView.as_view(), name='home')
```

Это позволяет проверить маршрут /home

---

## Соответствие ТЗ

| Требование                                          | Выполнено |
| --------------------------------------------------- |-----------|
| Меню через template tag                             | +         |
| Всё над активным пунктом развёрнуто                 | +         |
| Один уровень под активным развёрнут                 | +         |
| Меню хранится в БД                                  | +         |
| Редактируется в стандартной админке                 | +         |
| Активный пункт определяется по текущему URL         | +         |
| Поддержка нескольких меню по названию               | +         |
| URL может быть явным или `named_url`                | +         |
| Отрисовка выполняется одним запросом к БД           | +         |
| Используются только Django и стандартная библиотека | +         |


## Заключение

Меню создаются через админку, отображаются на любой странице, могут иметь произвольную вложенность и соответствуют всем условиям задания. Готово к проверке и расширению.

